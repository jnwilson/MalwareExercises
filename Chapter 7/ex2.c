#include<stdio.h>
#include <string>
#include <stdbool.h>
#include<Windows.h>
#include <Wininet.h>
#include<objbase.h>
#include<Ole2.h>
#include <OleAuto.h>
#include <ExDisp.h>
#pragma comment(lib, "wininet.lib")
#pragma comment(lib, "Ole32.lib")

int getInternetConnection(void);
int  main(){
	VARIANT var;
	V_VT(&var) = VT_I4;
	V_I4(&var) = 1;
	//var.iVal = 3;
	VariantInit(&var);
	BSTR myBSTR = SysAllocString(L"http://www.malwareanalysisbook.com/ad.html");
	HRESULT Result = OleInitialize(NULL);
	IWebBrowser2  * _IWebBrowser2;
	if (Result == S_OK)
	{

		HRESULT hResultTmp = CoCreateInstance(CLSID_InternetExplorer, NULL, CLSCTX_LOCAL_SERVER, IID_IWebBrowser2, (LPVOID *)&_IWebBrowser2);
		if (hResultTmp == S_OK){
			HRESULT test = _IWebBrowser2->Navigate(myBSTR, &var, NULL, NULL, NULL);
			_IWebBrowser2->put_Visible(VARIANT_TRUE);  //this makes the window appear.

		}
		SysFreeString(myBSTR);
		OleUninitialize();
	}

	return 1;
	
}


//GUID buff;
//GUID buff2;
//char* orig_iid_str = "{D30C1661-CDAF-11D0-8A3E-00C04FC9E26E}";
//char* orig_clsid_str = "{0002DF01-0000-0000-C000-000000000046}";
//size_t newsize_iid = strlen(orig_iid_str) + 1;
//size_t newsize_clsid = strlen(orig_clsid_str) + 1;
//wchar_t* new_iid = new wchar_t[newsize_iid];
//wchar_t* new_clsid = new wchar_t[newsize_clsid];
//size_t iid_convertedChars = 0;
//size_t clsid_convertedChars = 0;
//mbstowcs_s(&iid_convertedChars, new_iid, newsize_iid, orig_iid_str, _TRUNCATE);
//mbstowcs_s(&clsid_convertedChars, new_clsid, newsize_clsid, orig_clsid_str, _TRUNCATE);
///*wchar_t iid_str = L"{D30C1661-CDAF-11D0-8A3E-00C04FC9E26E}";
//wchar_t clsid_str = L"{871C5380-42A0-1069-A2EA-08002B30309D}";*/
//printf("Initialize Success");
//
//
//
//Result = CLSIDFromString(new_clsid, &buff2);
//Result = IIDFromString(new_iid, &buff);