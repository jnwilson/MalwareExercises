#include<stdio.h>
#include <stdbool.h>
#include<Windows.h>
#include <Wininet.h>
#include<objbase.h>
#include<Ole2.h>
#include <OleAuto.h>
#include <ExDisp.h>
//#pragma comment(lib,"shell32.lib")
#pragma comment(lib, "wininet.lib")
#pragma comment(lib, "Ole32.lib")
//Web browser (default)	{871C5380-42A0-1069-A2EA-08002B30309D}
//HKEY_LOCAL_MACHINE\SOFTWARE\Classes\Interface\{D30C1661-CDAF-11D0-8A3E-00C04FC9E26E}

// get internet connection first and than open up the book website to display the ad
int getInternetConnection(void);
int  main(){
	
	BSTR myBSTR = SysAllocString(L"http://www.malwareanalysisbook.com/ad.html");
	
	return getInternetConnection();





}

int getInternetConnection(){
	
	int a = InternetGetConnectedState(0, 0);
	if (1)
	{
		HRESULT Result = OleInitialize(NULL);
		if (Result== S_OK)
		{
			LPGUID* buff = NULL;
			LPGUID* buff2 = NULL;

			printf("Initialize Success");
//			CoCreateGuid()
			/*GUID *test;
			test->Data1 = 0x871C5380;
			test->Data2 = 0x42A0;*/
			Result= IIDFromString("{D30C1661-CDAF-11D0-8A3E-00C04FC9E26E}", buff);
			Result = CLSIDFromString("{871C5380-42A0-1069-A2EA-08002B30309D}", buff2);

			Result = CoCreateInstance(buff2, NULL, CLSCTX_SERVER, buff, NULL);

		}

		
		//CoInitialize(NULL);
		//IWebBrowser* IWebBrowser2 = NULL;
		////
		///*HRESULT CoCreateInstance(
		//	_In_  REFCLSID  rclsid,
		//	_In_  LPUNKNOWN pUnkOuter,
		//	_In_  DWORD     dwClsContext,
		//	_In_  REFIID    riid,
		//	_Out_ LPVOID    *ppv
		//	);
		//	*/
		//HRESULT h = CoCreateInstance(L, CLSCTX_SERVER, _riid(IID_IWebBrowser2), (LPVOID*)&IID_IWebBrowser2);
		//if (h==S_OK)
		//{
		//	printf("created a webbrowser");
		//}
		printf("Success: Internet Connection\n");
		return 1;
	}
	else
	{
		printf("Error1.1 No Internet\n");
		return 0;
	}


}

